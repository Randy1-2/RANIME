<!DOCTYPE html>
<html>
<head>
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <link rel="stylesheet" href="{{ url_for('static', filename='style.css') }}">
    <title>Ranime Anime Recommendations</title>

    <style>
        /* 2. BASE MOBILE-FRIENDLY STYLES */
        body {
            font-size: 18px; /* Bigger base font */
            margin: 0;
            padding: 10px;
        }

        .container h1 { font-size: 2.2rem; text-align: center; }

        .form {
            display: flex;
            flex-direction: column; /* Stack search on mobile */
            gap: 10px;
            margin-bottom: 25px;
        }

        .input {
            padding: 15px; /* Larger touch target */
            font-size: 1.1rem;
            width: 100%;
            box-sizing: border-box;
        }

        .button {
            padding: 15px;
            font-size: 1rem;
            width: 100%;
        }

        /* 3. RESPONSIVE TABLE TRANSFORMATION */
        @media screen and (max-width: 768px) {
            /* Force the table to not behave like a table */
            table, thead, tbody, th, td, tr {
                display: block;
            }

            /* Hide table headers (but keep for accessibility) */
            thead tr {
                position: absolute;
                top: -9999px;
                left: -9999px;
            }

            tr {
                margin-bottom: 20px;
                border: 2px solid #444;
                border-radius: 8px;
                background: #1a1a1a; /* Assuming a dark theme based on previous context */
                padding: 10px;
            }

            td {
                border: none;
                position: relative;
                padding-left: 50% !important;
                text-align: right;
                font-size: 1.1rem;
                border-bottom: 1px solid #333;
                padding-top: 12px;
                padding-bottom: 12px;
            }

            /* Label each row with the header title */
            td:before {
                position: absolute;
                left: 10px;
                width: 45%;
                padding-right: 10px;
                white-space: nowrap;
                content: attr(data-label);
                font-weight: bold;
                text-align: left;
                color: #ff4d4d;
            }

            td:last-child { border-bottom: 0; }
        }

        /* Desktop specific styling */
        @media screen and (min-width: 769px) {
            .form { flex-direction: row; }
            .input { width: auto; flex-grow: 1; }
            .button { width: auto; }
        }
    </style>
</head>
<body>

<div class="container">
    <h1>ANIME RECOMMENDATIONS</h1>
</div>

<form class="form" role="search" action="{{ url_for('search') }}" method="GET">
    <input class="input"
           type="search"
           placeholder="Search anime"
           aria-label="Search"
           name="query"
           value="{{ search_term if search_term else '' }}">
    <button class="button" type="submit">Search</button>

    {% if search_term %}
        <a href="{{ url_for('anime') }}" class="button" style="text-decoration: none; display: flex; align-items: center; justify-content: center; background: #555; color: white; border-radius: 4px;">Clear Search</a>
    {% endif %}
</form>

<table class="anime-list table">
  <thead>
    <tr>
      <th>Anime</th>
      <th>Year</th>
      <th>Main Character</th>
      <th>Genres</th>
      <th>Best sites</th>
      <th>Watched</th>
    </tr>
  </thead>
  <tbody>

  {% for anime in anime_data %}
    {% set clean_title = anime.title | lower | replace(':', '') | replace('!', '') | replace('\'', '') | replace('â€™', '') | replace('.', '') | replace(';', '') | replace('-', '') | strip() %}
    {% set final_id = clean_title | replace(' ', '-') %}

    <tr id="{{ final_id }}">
      <td data-label="Anime"><strong>{{ anime.title.upper() }}</strong></td>
      <td data-label="Year">{{ anime.year }}</td>
      <td data-label="Character">{{ anime.main_character }}</td>
      <td data-label="Genres">{{ anime.genres }}</td>
      <td data-label="Sites">
        <a href="https://animepahe.si/{{anime.title.lower()}}" target="_blank">Animepahe</a> |
          <a href="https://animeheaven.me/search.php?s={{anime.title.lower()}}" target="_blank">Animeheaven</a> |

      </td>
      <td data-label="Watched"><input type="checkbox" style="transform: scale(1.5);"></td>
    </tr>
  {% else %}
    <tr>
      <td colspan="6" style="text-align: center; padding: 20px;">
        <strong>No anime found matching your search.</strong>
      </td>
    </tr>
  {% endfor %}

  </tbody>
</table>

<footer>
  <div class="footer" style="padding-top: 30px; text-align: center;">
    <p>Made by Abs_being {{ date }}</p>
  </div>
</footer>
</body>
</html>